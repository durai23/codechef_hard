this is from branch dev-singularity
